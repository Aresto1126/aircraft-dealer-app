<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LUXURY-AIRCRAFT 顧客管理システム</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link href="style.css" rel="stylesheet">
</head>
<body class="bg-light">
    <!-- ナビゲーションバー -->
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
        <div class="container">
            <a class="navbar-brand d-flex align-items-center" href="#" id="home-link">
                <img src="img/logo.png" alt="Luxury Aircraft Logo" style="height:40px; width:auto; margin-right:10px;">
                <span>LUXURY-AIRCRAFT</span>
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <!-- 共有状態表示 -->
            <div class="store-connection">
                <div class="connection-status">
                    <div id="connection-indicator" class="indicator offline">
                        <span class="indicator-dot"></span>
                        <span id="connection-text">接続中...</span>
                    </div>
                    <div class="store-info">
                        <span id="online-users">接続中: 1人</span>
                    </div>
                </div>
            </div>
            
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item">
                        <a class="nav-link" href="#" onclick="showSectionAndCloseNav('tutorial')">
                            <i class="fas fa-graduation-cap"></i> チュートリアル
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#" onclick="showSectionAndCloseNav('customers')">
                            <i class="fas fa-users"></i> 顧客一覧
                        </a>
                    </li>

                    <li class="nav-item">
                        <a class="nav-link" href="#" onclick="showSectionAndCloseNav('sales')">
                            <i class="fas fa-chart-line"></i> 販売履歴
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#" onclick="showSectionAndCloseNav('cashbox')">
                            <i class="fas fa-vault"></i> 金庫管理
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#" onclick="showSectionAndCloseNav('salespeople')">
                            <i class="fas fa-user-tie"></i> 給与・販売員管理
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#" onclick="showSectionAndCloseNav('employment')">
                            <i class="fas fa-handshake"></i> 雇用管理
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#" onclick="showSectionAndCloseNav('inventory')">
                            <i class="fas fa-warehouse"></i> 在庫車両
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#" onclick="showSectionAndCloseNav('data-management')">
                            <i class="fas fa-database"></i> データ管理
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link btn btn-success ms-2" href="#" onclick="showSectionAndCloseNav('add-sale')">
                            <i class="fas fa-plus"></i> 販売追加
                        </a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <div class="container mt-4">

        <!-- ダッシュボード -->
        <div id="dashboard-section" class="section active">
            <div class="row mb-4">
                <div class="col-lg-3 col-md-4 mb-3">
                    <div class="card stats-card cashbox-card">
                        <div class="card-body text-center">
                            <i class="fas fa-vault fa-2x mb-3 text-warning"></i>
                            <h5 id="cashbox-balance">¥0</h5>
                            <p class="mb-0 small">金庫残高</p>
                        </div>
                    </div>
                </div>
                <div class="col-lg-3 col-md-4 mb-3">
                    <div class="card stats-card action-card">
                        <div class="card-body text-center">
                            <button class="btn btn-outline-primary btn-sm" onclick="showSectionAndCloseNav('cashbox')">
                                <i class="fas fa-vault"></i><br>
                                <span class="small">金庫管理</span>
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <div class="row">
                <div class="col-12">
                    <div class="card">
                        <div class="card-header">
                            <div class="d-flex justify-content-between align-items-center mb-2">
                                <h5 class="mb-0"><i class="fas fa-users"></i> 顧客一覧</h5>
                                <span class="badge bg-primary" id="customer-count">0名</span>
                            </div>
                            <div class="row align-items-center">
                                <div class="col-md-6">
                                    <div class="d-flex align-items-center">
                                        <label for="dashboard-sort" class="form-label me-2 mb-0 small">並び替え:</label>
                                                                <select class="form-select form-select-sm" id="dashboard-sort" onchange="handleDashboardSort()">
                            <option value="name-asc">名前 (あ→ん)</option>
                            <option value="name-desc">名前 (ん→あ)</option>
                            <option value="amount-desc">購入額 (高→低)</option>
                            <option value="amount-asc">購入額 (低→高)</option>
                            <option value="aircraft-desc">所有機数 (多→少)</option>
                            <option value="aircraft-asc">所有機数 (少→多)</option>
                            <option value="purchase-desc">購入日 (新→古)</option>
                            <option value="purchase-asc">購入日 (古→新)</option>
                        </select>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="card-body">
                            <div id="customers-grid" class="row">
                                <!-- 顧客カードがここに表示されます -->
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- チュートリアルセクション -->
        <div id="tutorial-section" class="section">
            <div class="card">
                <div class="card-header">
                    <h5><i class="fas fa-graduation-cap"></i> システムチュートリアル</h5>
                    <p class="mb-0 small text-muted">各機能の使い方を詳しく説明します</p>
                </div>
                <div class="card-body">
                    <!-- チュートリアル選択 -->
                    <div class="row mb-4">
                        <div class="col-md-12">
                            <div class="d-flex flex-wrap gap-2">
                                <button class="btn btn-outline-primary" onclick="showTutorial('overview')">
                                    <i class="fas fa-info-circle"></i> システム概要
                                </button>
                                <button class="btn btn-outline-success" onclick="showTutorial('dashboard')">
                                    <i class="fas fa-tachometer-alt"></i> ダッシュボード
                                </button>
                                <button class="btn btn-outline-info" onclick="showTutorial('customers')">
                                    <i class="fas fa-users"></i> 顧客管理
                                </button>
                                <button class="btn btn-outline-warning" onclick="showTutorial('sales')">
                                    <i class="fas fa-chart-line"></i> 販売管理
                                </button>
                                <button class="btn btn-outline-secondary" onclick="showTutorial('cashbox')">
                                    <i class="fas fa-vault"></i> 金庫管理
                                </button>
                                <button class="btn btn-outline-primary" onclick="showTutorial('salary')">
                                    <i class="fas fa-money-bill-wave"></i> 給与管理
                                </button>
                                <button class="btn btn-outline-danger" onclick="showTutorial('employment')">
                                    <i class="fas fa-user-tie"></i> 雇用管理
                                </button>
                                <button class="btn btn-outline-dark" onclick="showTutorial('inventory')">
                                    <i class="fas fa-warehouse"></i> 在庫管理
                                </button>
                                <button class="btn btn-outline-success" onclick="showTutorial('add-sale')">
                                    <i class="fas fa-plus"></i> 販売追加
                                </button>
                            </div>
                        </div>
                    </div>
                    
                    <!-- チュートリアル内容 -->
                    <div id="tutorial-content">
                        <div class="text-center py-5">
                            <i class="fas fa-graduation-cap fa-3x text-muted mb-3"></i>
                            <h4 class="text-muted">上のボタンから学習したい機能を選択してください</h4>
                            <p class="text-muted">各機能の詳細な使い方を画像付きで説明します</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- 顧客一覧セクション -->
        <div id="customers-section" class="section">
            <div class="card">
                <div class="card-header">
                    <div class="d-flex justify-content-between align-items-center mb-2">
                        <h5 class="mb-0"><i class="fas fa-users"></i> 顧客一覧</h5>
                    </div>
                    
                    <!-- 検索・フィルター機能 -->
                    <div class="row align-items-center mb-3">
                        <div class="col-md-4">
                            <div class="d-flex align-items-center">
                                <label for="customers-sort" class="form-label me-2 mb-0 small">並び替え:</label>
                                <select class="form-select form-select-sm" id="customers-sort" onchange="handleCustomersSort()">
                                    <option value="name-asc">名前 (あ→ん)</option>
                                    <option value="name-desc">名前 (ん→あ)</option>
                                    <option value="amount-desc">購入額 (高→低)</option>
                                    <option value="amount-asc">購入額 (低→高)</option>
                                    <option value="aircraft-desc">所有機数 (多→少)</option>
                                    <option value="aircraft-asc">所有機数 (少→多)</option>
                                    <option value="purchase-desc">購入日 (新→古)</option>
                                    <option value="purchase-asc">購入日 (古→新)</option>
                                </select>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="d-flex align-items-center">
                                <label for="aircraft-filter" class="form-label me-2 mb-0 small">航空機検索:</label>
                                <select class="form-select form-select-sm" id="aircraft-filter" onchange="handleAircraftFilter()">
                                    <option value="">すべての顧客</option>
                                    <!-- 航空機選択肢はJavaScriptで動的に生成されます -->
                                </select>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="d-flex align-items-center">
                                <label for="ownership-filter" class="form-label me-2 mb-0 small">所有状況:</label>
                                <select class="form-select form-select-sm" id="ownership-filter" onchange="handleOwnershipFilter()">
                                    <option value="all">全員</option>
                                    <option value="owner">所有者のみ</option>
                                    <option value="non-owner">非所有者のみ</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- 検索結果表示 -->
                    <div id="aircraft-search-result" class="alert alert-info" style="display: none;">
                        <!-- 検索結果の説明がここに表示されます -->
                    </div>
                </div>
                <div class="card-body">
                    <div class="table-responsive">
                        <table class="table table-hover">
                            <thead>
                                <tr>
                                    <th>顧客名</th>
                                    <th>読み仮名</th>
                                    <th>所有航空機数</th>
                                    <th>総購入額</th>
                                    <th>購入日</th>
                                    <th>操作</th>
                                </tr>
                            </thead>
                            <tbody id="customers-table">
                                <!-- 顧客データがここに表示されます -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>



        <!-- 販売履歴セクション -->
        <div id="sales-section" class="section">
            <div class="card">
                <div class="card-header">
                    <div class="d-flex justify-content-between align-items-center">
                        <h5 class="mb-0"><i class="fas fa-chart-line"></i> 販売履歴</h5>
                                                    <div>
                                <button class="btn btn-outline-primary btn-sm me-2" onclick="migrateToNewCalculationMethod()">
                                    <i class="fas fa-calculator"></i> 新計算方法に移行
                                </button>
                                <button class="btn btn-outline-danger btn-sm me-2" onclick="forceFullReinitialization()">
                                    <i class="fas fa-sync-alt"></i> 全データ再初期化
                                </button>
                                <button class="btn btn-outline-warning btn-sm" onclick="startManualDataMigration()">
                                    <i class="fas fa-database"></i> データ移行
                                </button>
                            </div>
                    </div>
                </div>
                <div class="card-body">
                    <div class="table-responsive">
                        <table class="table table-hover">
                            <thead>
                                <tr>
                                    <th>販売日</th>
                                    <th>顧客名</th>
                                    <th>航空機名</th>
                                    <th>台数</th>
                                    <th>販売方法</th>
                                    <th>総販売価格</th>
                                    <th>担当販売員</th>
                                    <th>販売員給与</th>
                                    <th>ディーラー利益</th>
                                    <th>操作</th>
                                </tr>
                            </thead>
                            <tbody id="sales-table">
                                <!-- 販売データがここに表示されます -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>

        <!-- データ管理セクション -->
        <div id="data-management-section" class="section">
            <div class="row">
                <!-- 同期機能 -->
                <div class="col-md-6 mb-4">
                    <div class="card">
                        <div class="card-header bg-primary text-white">
                            <h5 class="mb-0"><i class="fas fa-sync-alt"></i> データ同期機能</h5>
                        </div>
                        <div class="card-body">
                                                <div id="sync-status">
                        <div class="sync-status inactive">
                            <i class="fas fa-exclamation-circle"></i> GitHub Gist同期: 無効
                        </div>
                    </div>
                    
                    <div id="rate-limit-info" class="rate-limit-info" style="display: none;">
                        <h6><i class="fas fa-tachometer-alt"></i> APIレート制限情報</h6>
                        <div class="row">
                            <div class="col-md-6">
                                <small>残りリクエスト: <span id="rate-remaining">-</span></small>
                            </div>
                            <div class="col-md-6">
                                <small>リセット時刻: <span id="rate-reset">-</span></small>
                            </div>
                        </div>
                        <div class="progress mt-2" style="height: 8px;">
                            <div id="rate-progress" class="progress-bar" role="progressbar" style="width: 0%"></div>
                        </div>
                    </div>
                            
                            <div class="sync-info">
                                <h6><i class="fas fa-info-circle"></i> データ同期について</h6>
                                <p class="mb-2">GitHub Gistを使用してチーム全体でデータを自動同期できます。</p>
                                                                        <ul class="mb-0 small">
                                            <li>インテリジェント同期（変更時のみ実行）</li>
                                            <li>2分ごとにチェック、最大5分間隔で同期</li>
                                            <li>複数人同時作業対応</li>
                                            <li>データの競合を自動解決</li>
                                            <li>APIレート制限の自動管理</li>
                                        </ul>
                            </div>
                            
                            <div class="sync-controls">
                                <button class="btn btn-success" onclick="createDataGist()">
                                    <i class="fas fa-plus"></i> 新規同期作成
                                </button>
                                <button class="btn btn-primary" onclick="joinGistSync()">
                                    <i class="fas fa-link"></i> 同期に参加
                                </button>
                                <button class="btn btn-info" onclick="manualSync()">
                                    <i class="fas fa-sync"></i> 手動同期
                                </button>
                                <button class="btn btn-warning" onclick="disconnectGistSync()">
                                    <i class="fas fa-unlink"></i> 同期解除
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- データバックアップ・復元 -->
                <div class="col-md-6 mb-4">
                    <div class="card">
                        <div class="card-header bg-info text-white">
                            <h5 class="mb-0"><i class="fas fa-database"></i> データバックアップ</h5>
                        </div>
                        <div class="card-body">
                            <div class="sync-info">
                                <h6><i class="fas fa-shield-alt"></i> データの安全性</h6>
                                <p class="mb-2">重要なデータは定期的にバックアップを作成してください。</p>
                                <ul class="mb-0 small">
                                    <li>ローカルストレージに自動保存</li>
                                    <li>JSON形式でエクスポート可能</li>
                                    <li>ワンクリックでデータ復元</li>
                                    <li>データ整合性チェック機能</li>
                                </ul>
                            </div>
                            
                            <div class="sync-controls">
                                <button class="btn btn-success" onclick="exportAllData()">
                                    <i class="fas fa-download"></i> データエクスポート
                                </button>
                                <button class="btn btn-primary" onclick="importDataFromFile()">
                                    <i class="fas fa-upload"></i> データインポート
                                </button>
                                <button class="btn btn-warning" onclick="resetAllData()">
                                    <i class="fas fa-trash-alt"></i> 全データリセット
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- GitHub Pages デプロイ -->
            <div class="card">
                <div class="card-header bg-success text-white">
                    <h5 class="mb-0"><i class="fab fa-github"></i> GitHub Pages デプロイ</h5>
                </div>
                <div class="card-body">
                    <div class="sync-info">
                        <h6><i class="fas fa-globe"></i> Webサイトとして公開</h6>
                        <p>このアプリケーションを無料でWebサイトとして公開できます。</p>
                    </div>
                    
                    <div class="sync-setup-form">
                        <div class="row">
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label for="github-repo-url">GitHubリポジトリURL</label>
                                    <input type="url" id="github-repo-url" placeholder="https://github.com/username/repo-name">
                                </div>
                                <button class="btn btn-primary me-2" onclick="saveGitHubUrl()">
                                    <i class="fas fa-save"></i> URL保存
                                </button>
                                <button class="btn btn-outline-primary" onclick="openGitHubRepo()">
                                    <i class="fab fa-github"></i> リポジトリを開く
                                </button>
                            </div>
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label for="github-pages-url">公開URL</label>
                                    <input type="url" id="github-pages-url" placeholder="https://username.github.io/repo-name">
                                </div>
                                <button class="btn btn-success me-2" onclick="savePublicUrl()">
                                    <i class="fas fa-save"></i> URL保存
                                </button>
                                <button class="btn btn-outline-success" onclick="openPublicPage()">
                                    <i class="fas fa-external-link-alt"></i> サイトを開く
                                </button>
                            </div>
                        </div>
                    </div>
                    
                    <div class="sync-controls">
                        <button class="btn btn-info" onclick="downloadAllFiles()">
                            <i class="fas fa-download"></i> 全ファイルダウンロード
                        </button>
                        <button class="btn btn-primary" onclick="copyPublicUrl()">
                            <i class="fas fa-copy"></i> URLをコピー
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- 販売追加セクション -->
        <div id="add-sale-section" class="section">
            <div class="card">
                <div class="card-header">
                    <h5><i class="fas fa-plus"></i> 新規販売登録</h5>
                </div>
                <div class="card-body">
                    <form id="sale-form">
                        <div class="row">
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="customer-select" class="form-label">顧客選択</label>
                                    <select class="form-select" id="customer-select" required onchange="handleCustomerChange(this)">
                                        <option value="">選択してください</option>
                                        <option value="new">新規顧客</option>
                                    </select>
                                    <div class="text-muted small">既存顧客または新規顧客を選択</div>
                                </div>
                                <div class="mb-3" id="new-customer-container" style="display: none;">
                                    <label for="customer-name" class="form-label">新規顧客名</label>
                                    <input type="text" class="form-control" id="customer-name">
                                    <div class="text-muted small">新規顧客の名前を入力してください</div>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="sale-method" class="form-label">
                                        <i class="fas fa-cogs text-primary"></i> 販売方法選択
                                    </label>
                                    <select class="form-select border-primary" id="sale-method" onchange="handleSaleMethodChange(event)">
                                        <option value="inventory-priority">在庫から販売（優先・仕入れ0円）</option>
                                        <option value="new-purchase">新規仕入れで販売</option>
                                    </select>
                                    <div id="sale-method-info" class="text-success small">在庫がある場合は仕入れコスト0円で販売</div>
                                </div>
                                <div class="mb-3">
                                    <label for="aircraft-name" class="form-label">
                                        <i class="fas fa-plane text-secondary"></i> 航空機選択
                                    </label>
                                    <select class="form-select" id="aircraft-name" required onchange="handleAircraftChange(event)">
                                        <option value="">選択してください</option>
                                        <!-- 航空機選択肢はJavaScriptで動的に生成されます -->
                                    </select>
                                    <div id="aircraft-info" class="text-muted small mt-1">
                                        航空機を選択してください
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="salesperson-select" class="form-label">担当販売員</label>
                                    <select class="form-select" id="salesperson-select" required>
                                        <option value="">選択してください</option>
                                        <!-- 販売員選択肢はJavaScriptで動的に生成されます -->
                                    </select>
                                    <div class="text-muted small">販売を担当する販売員を選択してください</div>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="sale-date" class="form-label">販売日</label>
                                    <input type="datetime-local" class="form-control" id="sale-date" required>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-3">
                                <div class="mb-3">
                                    <label for="quantity" class="form-label">台数</label>
                                    <input type="number" class="form-control" id="quantity" min="1" value="1" required oninput="updateDiscountCalculation()">
                                    <div class="text-muted small">購入台数</div>
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="mb-3">
                                    <label for="sale-price" class="form-label">単価 (円)</label>
                                    <input type="number" class="form-control" id="sale-price" min="0" required oninput="updateDiscountCalculation()">
                                    <div id="price-info" class="text-info small mt-1"></div>
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="mb-3">
                                    <label for="discount-rate" class="form-label">割引率 (%)</label>
                                    <input type="number" class="form-control" id="discount-rate" min="0" max="70" value="0" oninput="updateDiscountCalculation()">
                                    <div class="text-muted small">1台分のみ適用</div>
                                    <div id="discount-info" class="mt-1"></div>
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="mb-3">
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" id="is-gift" onchange="handleGiftChange()">
                                        <label class="form-check-label" for="is-gift">
                                            <i class="fas fa-gift"></i> プレゼント
                                        </label>
                                    </div>
                                    <div class="text-muted small">無料でプレゼントする場合</div>
                                </div>
                            </div>
                        </div>
                        <!-- 新規航空機登録フォーム -->
                        <div class="mb-3" id="new-aircraft-container" style="display: none;">
                            <div class="card border-info">
                                <div class="card-header bg-info text-white">
                                    <h6 class="mb-0"><i class="fas fa-plus"></i> 新規航空機登録</h6>
                                </div>
                                <div class="card-body">
                                    <div class="row">
                                        <div class="col-md-6">
                                            <div class="mb-3">
                                                <label for="new-aircraft-name" class="form-label">航空機名</label>
                                                <input type="text" class="form-control" id="new-aircraft-name" placeholder="例: Boeing 747">
                                                <div class="text-muted small">新しい航空機の名前を入力してください</div>
                                            </div>
                                        </div>
                                        <div class="col-md-6">
                                            <div class="mb-3">
                                                <label for="new-aircraft-category" class="form-label">カテゴリ</label>
                                                <select class="form-select" id="new-aircraft-category">
                                                    <option value="">選択してください</option>
                                                    <option value="ヘリコプター (Vanila)">ヘリコプター (Vanila)</option>
                                                    <option value="MOD">MOD</option>
                                                    <option value="海外実車">海外実車</option>
                                                    <option value="軍事車両">軍事車両</option>
                                                    <option value="飛行機">飛行機</option>
                                                    <option value="その他">その他</option>
                                                </select>
                                                <div class="text-muted small">航空機のカテゴリを選択してください</div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="col-md-6">
                                            <div class="mb-3">
                                                <label for="new-aircraft-price" class="form-label">定価 (円)</label>
                                                <input type="number" class="form-control" id="new-aircraft-price" min="1" placeholder="100000000">
                                                <div class="text-muted small">航空機の定価を入力してください</div>
                                            </div>
                                        </div>
                                        <div class="col-md-6">
                                            <div class="mb-3">
                                                <label for="new-aircraft-english" class="form-label">英語名（任意）</label>
                                                <input type="text" class="form-control" id="new-aircraft-english" placeholder="例: Boeing 747">
                                                <div class="text-muted small">英語名（任意）</div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="d-flex gap-2">
                                        <button type="button" class="btn btn-info" onclick="registerNewAircraft()">
                                            <i class="fas fa-save"></i> 航空機を登録
                                        </button>
                                        <button type="button" class="btn btn-secondary" onclick="cancelNewAircraft()">
                                            <i class="fas fa-times"></i> キャンセル
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- 新規仕入れフォーム -->
                        <div class="mb-3" id="new-purchase-container" style="display: none;">
                            <div class="card border-success">
                                <div class="card-header bg-success text-white">
                                    <h6 class="mb-0"><i class="fas fa-truck"></i> 新規仕入れ情報</h6>
                                </div>
                                <div class="card-body">
                                    <div class="row">
                                        <div class="col-md-6">
                                            <div class="mb-3">
                                                <label for="purchase-aircraft-name" class="form-label">航空機選択</label>
                                                <select class="form-select" id="purchase-aircraft-name" onchange="handlePurchaseAircraftChange(event)">
                                                    <option value="">航空機を選択してください</option>
                                                    <!-- 航空機選択肢はJavaScriptで動的に生成されます -->
                                                </select>
                                                <div class="text-muted small">仕入れする航空機を選択してください</div>
                                            </div>
                                        </div>
                                        <div class="col-md-6">
                                            <div class="mb-3">
                                                <label for="purchase-quantity" class="form-label">仕入れ数量</label>
                                                <input type="number" class="form-control" id="purchase-quantity" min="1" value="1" onchange="updatePurchaseCalculation()">
                                                <div class="text-muted small">仕入れする数量を入力してください</div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="col-md-6">
                                            <div class="mb-3">
                                                <label for="purchase-price-per-unit" class="form-label">仕入れ単価（円）</label>
                                                <input type="number" class="form-control" id="purchase-price-per-unit" min="1" onchange="updatePurchaseCalculation()">
                                                <div class="text-muted small" id="purchase-price-suggestion">推奨仕入れ価格が表示されます</div>
                                            </div>
                                        </div>
                                        <div class="col-md-6">
                                            <div class="mb-3">
                                                <label class="form-label">仕入れ合計</label>
                                                <div class="form-control-plaintext fw-bold" id="purchase-total-display">¥0</div>
                                                <div class="text-muted small">仕入れ単価 × 数量</div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="alert alert-info">
                                        <i class="fas fa-info-circle"></i> 
                                        <strong>新規仕入れ販売</strong>: 仕入れと同時に販売を行います。余剰分は在庫として保管されます。
                                    </div>
                                    <div class="d-flex gap-2">
                                        <button type="button" class="btn btn-success" onclick="confirmNewPurchase()">
                                            <i class="fas fa-check"></i> 仕入れ情報を確定
                                        </button>
                                        <button type="button" class="btn btn-secondary" onclick="cancelNewPurchase()">
                                            <i class="fas fa-times"></i> キャンセル
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <button type="submit" class="btn btn-primary">
                            <i class="fas fa-save"></i> 販売を登録
                        </button>
                        <button type="button" class="btn btn-secondary ms-2" onclick="clearForm()">
                            <i class="fas fa-times"></i> クリア
                        </button>
                    </form>
                </div>
            </div>
        </div>

        <!-- 金庫管理セクション -->
        <div id="cashbox-section" class="section">
            <div class="row">
                <!-- 現在の金庫状況 -->
                <div class="col-md-4 mb-4">
                    <div class="card cashbox-status-card">
                        <div class="card-header bg-warning text-dark">
                            <h5 class="mb-0"><i class="fas fa-vault"></i> 金庫状況</h5>
                        </div>
                        <div class="card-body text-center">
                            <i class="fas fa-vault fa-4x mb-3 text-warning"></i>
                            <h3 class="text-warning mb-3">
                                現在残高
                            </h3>
                            <h2 class="price-tag mb-4" id="cashbox-current-balance">¥0</h2>
                            <div class="row text-center">
                                <div class="col-6">
                                    <small class="text-muted">入金回数</small>
                                    <h6 id="deposit-count">0回</h6>
                                </div>
                                <div class="col-6">
                                    <small class="text-muted">出金回数</small>
                                    <h6 id="withdrawal-count">0回</h6>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 手動操作 -->
                <div class="col-md-8 mb-4">
                    <div class="card">
                        <div class="card-header">
                            <h5 class="mb-0"><i class="fas fa-hand-holding-usd"></i> 手動操作</h5>
                        </div>
                        <div class="card-body">
                            <div class="row">
                                <!-- 手動入金フォーム -->
                                <div class="col-lg-4 col-md-6 mb-3">
                                    <div class="card border-success">
                                        <div class="card-header bg-success text-white">
                                            <h6 class="mb-0"><i class="fas fa-plus-circle"></i> 手動入金</h6>
                                        </div>
                                        <div class="card-body">
                                            <form id="deposit-form">
                                                <div class="mb-3">
                                                    <label for="deposit-amount" class="form-label">入金額 (円)</label>
                                                    <input type="number" class="form-control" id="deposit-amount" min="1" required>
                                                </div>
                                                <div class="mb-3">
                                                    <label for="deposit-description" class="form-label">内容</label>
                                                    <input type="text" class="form-control" id="deposit-description" placeholder="例: 外部収入、補填" required>
                                                </div>
                                                <button type="submit" class="btn btn-success w-100">
                                                    <i class="fas fa-plus-circle"></i> 入金実行
                                                </button>
                                            </form>
                                        </div>
                                    </div>
                                </div>

                                <!-- 出金フォーム -->
                                <div class="col-lg-4 col-md-6 mb-3">
                                    <div class="card border-danger">
                                        <div class="card-header bg-danger text-white">
                                            <h6 class="mb-0"><i class="fas fa-minus-circle"></i> 手動出金</h6>
                                        </div>
                                        <div class="card-body">
                                            <form id="withdrawal-form">
                                                <div class="mb-3">
                                                    <label for="withdrawal-amount" class="form-label">出金額 (円)</label>
                                                    <input type="number" class="form-control" id="withdrawal-amount" min="1" required>
                                                </div>
                                                <div class="mb-3">
                                                    <label for="withdrawal-description" class="form-label">内容</label>
                                                    <input type="text" class="form-control" id="withdrawal-description" placeholder="例: イベント支払い" required>
                                                </div>
                                                <button type="submit" class="btn btn-danger w-100">
                                                    <i class="fas fa-minus-circle"></i> 出金実行
                                                </button>
                                            </form>
                                        </div>
                                    </div>
                                </div>

                                <!-- 残高調整フォーム -->
                                <div class="col-lg-4 col-md-12 mb-3">
                                    <div class="card border-info">
                                        <div class="card-header bg-info text-white">
                                            <h6 class="mb-0"><i class="fas fa-edit"></i> 残高調整</h6>
                                        </div>
                                        <div class="card-body">
                                            <form id="adjustment-form">
                                                <div class="mb-3">
                                                    <label for="adjustment-balance" class="form-label">新しい残高 (円)</label>
                                                    <input type="number" class="form-control" id="adjustment-balance" min="0" required>
                                                </div>
                                                <div class="mb-3">
                                                    <label for="adjustment-description" class="form-label">調整理由</label>
                                                    <input type="text" class="form-control" id="adjustment-description" placeholder="例: 手動修正、実地確認" required>
                                                </div>
                                                <button type="submit" class="btn btn-info w-100">
                                                    <i class="fas fa-edit"></i> 残高調整
                                                </button>
                                            </form>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 金庫履歴 -->
            <div class="card">
                <div class="card-header">
                    <div class="d-flex justify-content-between align-items-center">
                        <h5 class="mb-0"><i class="fas fa-history"></i> 金庫履歴</h5>
                        <button class="btn btn-outline-warning btn-sm" onclick="forceCashboxReconstruction()">
                            <i class="fas fa-sync"></i> 金庫データ再構築
                        </button>
                    </div>
                </div>
                <div class="card-body">
                    <div class="table-responsive">
                        <table class="table table-hover">
                            <thead>
                                <tr>
                                    <th>日時</th>
                                    <th>種類</th>
                                    <th>金額</th>
                                    <th>内容</th>
                                    <th>残高</th>
                                </tr>
                            </thead>
                            <tbody id="cashbox-history-table">
                                <!-- 金庫履歴がここに表示されます -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>

        <!-- 在庫車両管理セクション -->
        <div id="inventory-section" class="section">
            <div class="row">
                <!-- 在庫統計 -->
                <div class="col-md-4 mb-4">
                    <div class="card">
                        <div class="card-header bg-primary text-white">
                            <h5 class="mb-0"><i class="fas fa-warehouse"></i> 在庫状況</h5>
                        </div>
                        <div class="card-body text-center">
                            <i class="fas fa-plane fa-4x mb-3 text-primary"></i>
                            <h3 class="text-primary mb-3">在庫車両</h3>
                            <h2 class="mb-4" id="inventory-count">0台</h2>
                            <div class="row text-center">
                                <div class="col-6">
                                    <small class="text-muted">総在庫価値</small>
                                    <h6 class="price-tag" id="inventory-value">¥0</h6>
                                </div>
                                <div class="col-6">
                                    <small class="text-muted">仕入コスト</small>
                                    <h6 class="text-info" id="inventory-cost">¥0</h6>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 在庫追加フォーム -->
                <div class="col-md-8 mb-4">
                    <div class="card">
                        <div class="card-header">
                            <h5 class="mb-0"><i class="fas fa-plus"></i> 在庫車両追加</h5>
                        </div>
                        <div class="card-body">
                            <form id="inventory-form">
                                <div class="row">
                                    <div class="col-md-6">
                                        <div class="mb-3">
                                            <label for="inventory-aircraft-name" class="form-label">航空機名</label>
                                            <select class="form-select" id="inventory-aircraft-name" required>
                                                <option value="">選択してください</option>
                                                <!-- 航空機選択肢はJavaScriptで動的に生成されます -->
                                            </select>
                                            <div id="inventory-aircraft-info" class="text-muted small mt-1">
                                                航空機を選択してください
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <div class="mb-3">
                                            <label for="inventory-quantity" class="form-label">在庫数</label>
                                            <input type="number" class="form-control" id="inventory-quantity" min="1" value="1" required>
                                            <div class="text-muted small">追加する在庫数</div>
                                        </div>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-md-6">
                                        <div class="mb-3">
                                            <label for="inventory-purchase-price" class="form-label">仕入価格 (円)</label>
                                            <input type="number" class="form-control" id="inventory-purchase-price" min="0" required>
                                            <div id="inventory-price-info" class="text-info small mt-1"></div>
                                        </div>
                                        <div class="mb-3">
                                            <div class="form-check">
                                                <input class="form-check-input" type="checkbox" id="inventory-free-stock" onchange="handleFreeStockChange()">
                                                <label class="form-check-label" for="inventory-free-stock">
                                                    <i class="fas fa-gift"></i> 無償在庫（仕入価格0円）
                                                </label>
                                            </div>
                                            <div class="text-muted small">もともとディーラーにあった車両など</div>
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <div class="mb-3">
                                            <label for="inventory-date" class="form-label">仕入日</label>
                                            <input type="datetime-local" class="form-control" id="inventory-date" required>
                                        </div>
                                    </div>
                                </div>
                                <div class="mb-3">
                                    <label for="inventory-notes" class="form-label">メモ</label>
                                    <input type="text" class="form-control" id="inventory-notes" placeholder="例: 新品、中古、特殊仕様など">
                                    <div class="text-muted small">在庫に関するメモ（任意）</div>
                                </div>
                                <button type="submit" class="btn btn-primary">
                                    <i class="fas fa-save"></i> 在庫追加
                                </button>
                                <button type="button" class="btn btn-secondary ms-2" onclick="clearInventoryForm()">
                                    <i class="fas fa-times"></i> クリア
                                </button>
                            </form>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 在庫一覧 -->
            <div class="card">
                <div class="card-header">
                    <h5 class="mb-0"><i class="fas fa-list"></i> 在庫車両一覧</h5>
                </div>
                <div class="card-body">
                    <div class="table-responsive">
                        <table class="table table-hover">
                            <thead>
                                <tr>
                                    <th>航空機名</th>
                                    <th>在庫数</th>
                                    <th>仕入価格</th>
                                    <th>仕入日</th>
                                    <th>種別</th>
                                    <th>メモ</th>
                                    <th>操作</th>
                                </tr>
                            </thead>
                            <tbody id="inventory-table">
                                <!-- 在庫データがここに表示されます -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>

        <!-- 給与・販売員管理セクション -->
        <div id="salespeople-section" class="section">
            <div class="row mb-4">
                <!-- 給与管理カード -->
                <div class="col-md-6 mb-3">
                    <div class="card">
                        <div class="card-header bg-warning text-dark">
                            <h5><i class="fas fa-money-bill-wave"></i> 給与管理</h5>
                        </div>
                        <div class="card-body">
                            <div class="row text-center">
                                <div class="col-6">
                                    <div class="card stats-card">
                                        <div class="card-body">
                                            <h4 class="text-warning" id="total-pending-salary">¥0</h4>
                                            <small class="text-muted">未払い給与合計</small>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-6">
                                    <div class="card stats-card">
                                        <div class="card-body">
                                            <button class="btn btn-success btn-sm" onclick="payAllSalaries()" id="pay-all-salaries-btn">
                                                <i class="fas fa-money-bill-wave"></i><br>
                                                <span class="small">全員給与支払い</span>
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="mt-3">
                                <div class="alert alert-info">
                                    <h6><i class="fas fa-info-circle"></i> 給与管理について</h6>
                                    <p class="mb-0 small">Discordの「販売報告」チャンネルで各販売員が投稿した販売報告に対してチェックのリアクションを付けることで、給与が計算されます。サイト上で「全員給与支払い」ボタンを押すことで、未払い給与を一括で支払った判定になります。</p>
                                    <button class="btn btn-outline-warning btn-sm mt-2" onclick="forceSalaryReconstruction()">
                                        <i class="fas fa-sync"></i> 給与記録再構築
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 給与詳細カード -->
                <div class="col-md-6 mb-3">
                    <div class="card">
                        <div class="card-header bg-info text-white">
                            <h5><i class="fas fa-chart-bar"></i> 給与詳細</h5>
                        </div>
                        <div class="card-body">
                            <div id="salary-details">
                                <!-- 給与詳細がここに表示されます -->
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 販売員一覧 -->
            <div class="card">
                <div class="card-header">
                    <h5><i class="fas fa-user-tie"></i> 販売員一覧</h5>
                </div>
                <div class="card-body">
                    <div class="table-responsive">
                        <table class="table table-hover">
                            <thead>
                                <tr>
                                    <th>販売員名</th>
                                    <th>雇用日</th>
                                    <th>売上実績</th>
                                    <th>未払い給与</th>
                                    <th>受取給与</th>
                                    <th>雇用状態</th>
                                    <th>操作</th>
                                </tr>
                            </thead>
                            <tbody id="salespeople-table">
                                <!-- 販売員データがここに表示されます -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>

        <!-- 雇用管理セクション -->
        <div id="employment-section" class="section">
            <div class="row">
                <!-- 新規雇用フォーム -->
                <div class="col-md-6 mb-4">
                    <div class="card">
                        <div class="card-header">
                            <h5><i class="fas fa-plus"></i> 新規販売員雇用</h5>
                        </div>
                        <div class="card-body">
                            <form id="employment-form">
                                <div class="mb-3">
                                    <label for="salesperson-name" class="form-label">販売員名</label>
                                    <input type="text" class="form-control" id="salesperson-name" required>
                                    <div class="text-muted small">雇用する販売員の名前を入力してください</div>
                                </div>
                                <div class="mb-3">
                                    <label for="employment-date" class="form-label">雇用日</label>
                                    <input type="date" class="form-control" id="employment-date" required>
                                    <div class="text-muted small">雇用開始日を設定してください</div>
                                </div>
                                <div class="mb-3">
                                    <label for="employment-note" class="form-label">雇用メモ</label>
                                    <input type="text" class="form-control" id="employment-note" placeholder="例: 優秀な営業スキル、航空機知識豊富">
                                    <div class="text-muted small">雇用に関するメモ（任意）</div>
                                </div>
                                <button type="submit" class="btn btn-primary w-100">
                                    <i class="fas fa-handshake"></i> 雇用登録
                                </button>
                            </form>
                        </div>
                    </div>
                </div>

                <!-- 雇用統計 -->
                <div class="col-md-6 mb-4">
                    <div class="card">
                        <div class="card-header">
                            <h5><i class="fas fa-chart-pie"></i> 雇用統計</h5>
                        </div>
                        <div class="card-body">
                            <div class="row text-center">
                                <div class="col-3">
                                    <div class="card stats-card">
                                        <div class="card-body">
                                            <h4 class="text-primary" id="active-salespeople-count">0</h4>
                                            <small class="text-muted">在籍販売員</small>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-3">
                                    <div class="card stats-card">
                                        <div class="card-body">
                                            <h4 class="text-warning" id="leave-salespeople-count">0</h4>
                                            <small class="text-muted">休職販売員</small>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-3">
                                    <div class="card stats-card">
                                        <div class="card-body">
                                            <h4 class="text-success" id="total-sales-count">0</h4>
                                            <small class="text-muted">総売上件数</small>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-3">
                                    <div class="card stats-card">
                                        <div class="card-body">
                                            <h4 class="text-warning" id="total-commission-paid">¥0</h4>
                                            <small class="text-muted">総支払給与</small>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 雇用履歴 -->
            <div class="card">
                <div class="card-header">
                    <h5><i class="fas fa-history"></i> 雇用履歴</h5>
                </div>
                <div class="card-body">
                    <div class="table-responsive">
                        <table class="table table-hover">
                            <thead>
                                <tr>
                                    <th>雇用日</th>
                                    <th>販売員名</th>
                                    <th>雇用メモ</th>
                                    <th>雇用状態</th>
                                    <th>操作</th>
                                </tr>
                            </thead>
                            <tbody id="employment-history-table">
                                <!-- 雇用履歴がここに表示されます -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- 顧客詳細モーダル -->
    <div class="modal fade" id="customerModal" tabindex="-1">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title"><i class="fas fa-user"></i> 顧客詳細</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body" id="customer-modal-content">
                    <!-- 顧客詳細情報がここに表示されます -->
                </div>
            </div>
        </div>
    </div>

    <!-- データ移行モーダル -->
    <div class="modal fade" id="dataMigrationModal" tabindex="-1" data-bs-backdrop="static" data-bs-keyboard="false">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header bg-warning text-dark">
                    <h5 class="modal-title"><i class="fas fa-database"></i> 既存データの販売員情報更新</h5>
                </div>
                <div class="modal-body">
                    <div class="alert alert-info">
                        <h6><i class="fas fa-info-circle"></i> データ移行について</h6>
                        <p>販売員情報が不足している既存の売上履歴が見つかりました。各販売記録に販売員を割り当てることで、正確な給与計算と統計を行うことができます。</p>
                    </div>

                    <div id="migration-records-container">
                        <!-- 移行対象の販売記録がここに表示されます -->
                    </div>

                    <div class="alert alert-warning">
                        <h6><i class="fas fa-exclamation-triangle"></i> 注意事項</h6>
                        <ul class="mb-0">
                            <li>販売員を割り当てることで、販売員給与が正しく計算されます</li>
                            <li>金庫残高は自動的に調整されます</li>
                            <li>この操作は元に戻すことができません</li>
                        </ul>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" onclick="skipDataMigration()">
                        <i class="fas fa-times"></i> 後で行う
                    </button>
                    <button type="button" class="btn btn-primary" onclick="executeDataMigration()">
                        <i class="fas fa-database"></i> データ移行を実行
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- 販売記録編集モーダル -->
    <div class="modal fade" id="editSaleModal" tabindex="-1">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title"><i class="fas fa-edit"></i> 販売記録編集</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form id="edit-sale-form">
                        <input type="hidden" id="edit-sale-id">
                        
                        <!-- 基本情報（読み取り専用） -->
                        <div class="alert alert-info">
                            <h6><i class="fas fa-info-circle"></i> 編集対象の販売記録</h6>
                            <div class="row">
                                <div class="col-md-6">
                                    <strong>顧客名:</strong> <span id="edit-customer-name-display"></span>
                                </div>
                                <div class="col-md-6">
                                    <strong>元の販売価格:</strong> <span id="edit-original-price-display"></span>
                                </div>
                            </div>
                        </div>

                        <div class="row">
                            <!-- 航空機名 -->
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="edit-aircraft-name" class="form-label">航空機名</label>
                                    <select class="form-select" id="edit-aircraft-name" required>
                                        <option value="">選択してください</option>
                                        <!-- 航空機選択肢はJavaScriptで動的に生成されます -->
                                    </select>
                                </div>
                            </div>
                            
                            <!-- 担当販売員 -->
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="edit-salesperson-select" class="form-label">担当販売員</label>
                                    <select class="form-select" id="edit-salesperson-select" required>
                                        <option value="">選択してください</option>
                                        <!-- 販売員選択肢はJavaScriptで動的に生成されます -->
                                    </select>
                                </div>
                            </div>
                        </div>
                        
                        <div class="row">
                            <!-- 台数 -->
                            <div class="col-md-3">
                                <div class="mb-3">
                                    <label for="edit-quantity" class="form-label">台数</label>
                                    <input type="number" class="form-control" id="edit-quantity" min="1" required oninput="updateEditDiscountCalculation()">
                                </div>
                            </div>
                            
                            <!-- 単価 -->
                            <div class="col-md-3">
                                <div class="mb-3">
                                    <label for="edit-sale-price" class="form-label">単価 (円)</label>
                                    <input type="number" class="form-control" id="edit-sale-price" min="0" required oninput="updateEditDiscountCalculation()">
                                    <div id="edit-price-info" class="text-info small mt-1"></div>
                                </div>
                            </div>
                            
                            <!-- 割引率 -->
                            <div class="col-md-3">
                                <div class="mb-3">
                                    <label for="edit-discount-rate" class="form-label">割引率 (%)</label>
                                    <input type="number" class="form-control" id="edit-discount-rate" min="0" max="70" oninput="updateEditDiscountCalculation()">
                                    <div class="text-muted small">1台分のみ適用</div>
                                    <div id="edit-discount-info" class="mt-1"></div>
                                </div>
                            </div>
                            
                            <!-- 販売日 -->
                            <div class="col-md-3">
                                <div class="mb-3">
                                    <label for="edit-sale-date" class="form-label">販売日</label>
                                    <input type="datetime-local" class="form-control" id="edit-sale-date" required>
                                </div>
                            </div>
                        </div>

                        <!-- カスタム航空機入力フィールド -->
                        <div class="mb-3" id="edit-custom-aircraft-container" style="display: none;">
                            <label for="edit-custom-aircraft" class="form-label">航空機名（カスタム）</label>
                            <input type="text" class="form-control" id="edit-custom-aircraft">
                        </div>

                        <!-- 計算結果表示 -->
                        <div class="alert alert-secondary" id="edit-calculation-result">
                            <h6><i class="fas fa-calculator"></i> 計算結果</h6>
                            <div id="edit-calculation-details"></div>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
                        <i class="fas fa-times"></i> キャンセル
                    </button>
                    <button type="button" class="btn btn-primary" onclick="saveSaleEdit()">
                        <i class="fas fa-save"></i> 保存
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- 通知ポップアップモーダル -->
    <div class="modal fade" id="notificationModal" tabindex="-1" data-bs-backdrop="static" data-bs-keyboard="false">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header" id="notification-header">
                    <h5 class="modal-title" id="notification-title">
                        <i class="fas fa-check-circle text-success"></i> 登録完了
                    </h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body text-center" id="notification-body">
                    <!-- 通知内容がここに表示されます -->
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-primary" data-bs-dismiss="modal">
                        <i class="fas fa-check"></i> OK
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- トースト通知エリア -->
    <div class="toast-container position-fixed bottom-0 end-0 p-3" style="z-index: 11;">
        <div id="successToast" class="toast align-items-center text-white bg-success border-0" role="alert">
            <div class="d-flex">
                <div class="toast-body" id="toast-message">
                    <!-- トーストメッセージがここに表示されます -->
                </div>
                <button type="button" class="btn-close btn-close-white me-2 m-auto" data-bs-dismiss="toast"></button>
            </div>
        </div>
        <div id="errorToast" class="toast align-items-center text-white bg-danger border-0" role="alert">
            <div class="d-flex">
                <div class="toast-body" id="error-toast-message">
                    <!-- エラーメッセージがここに表示されます -->
                </div>
                <button type="button" class="btn-close btn-close-white me-2 m-auto" data-bs-dismiss="toast"></button>
            </div>
        </div>
    </div>

    <footer class="bg-dark text-light text-center py-3 mt-5">
        <div class="container">
            <p>&copy; 2024 LUXURY-AIRCRAFT 顧客管理システム. FiveM Server Management.</p>
        </div>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="script.js"></script>
</body>
</html> 